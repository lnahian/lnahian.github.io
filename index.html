<HTML>
<HEAD>

<TITLE>Paste FHIR Message in JSON Format</TITLE>

<SCRIPT LANGUAGE="JavaScript">

function testResults (form) {

	var validFormat = true; 

    //Creates variable to hold FHIR JSON data
    var txt = form.inputbox.value;
    var formattedString;

    try {
		var obj = JSON.parse(txt);
		//Creates string of conditions in proper list format 
			var str = '<p>';
			for (var i = 0; i < obj.conditions.length; i++) {
  			str += '- ' + obj.conditions[i] + '<p>';
			}

		//Information to Display 
		//Name of patient:
		//Organization name:
		//Gender:
		//Number of conditions they have:
		//List of all conditions:

		//Creates string of patient attributes to display
		formattedString = 'Name of Patient:' + obj.name.given + ' ' + obj.name.family + '<p>' + 'Managing Organization: ' + obj.managingOrganization.display + '<p>' + 'Gender: ' + obj.gender + '<p>' + 'Number of Conditions: ' + obj.conditions.length + '<p>' + 'List of Conditions: ' + str;
	}
	catch (e) {
		formattedString = "FHIR Message Incorrectly Formatted!"
		alert(formattedString);
	}

	//Displays patient attributes 
	document.write(formattedString);
 
}
</SCRIPT>

</HEAD>
<BODY>

<FORM NAME="myform" ACTION="" METHOD="GET">Paste FHIR Message in JSON Format: <BR>
<INPUT TYPE="text" NAME="inputbox" VALUE=""><P>

<INPUT TYPE="button" NAME="button" Value="Submit" onClick="testResults(this.form)">

</FORM>
</BODY>
</HTML>
